<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Chart - Finance Joshi</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 40px;
            background: white;
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .mermaid {
            background: white;
            padding: 20px;
            border-radius: 8px;
        }
        .instructions {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="instructions">
            <strong>To save as image:</strong> Right-click on the diagram → Save image as → Choose location
            <br>Or use browser screenshot tool: Press F12 → Ctrl+Shift+P → Type "screenshot" → "Capture full size screenshot"
        </div>
        <h1>Finance Joshi - Project Workflow Chart</h1>
        <div class="mermaid">
flowchart TB
    Start([User Opens App]) --> CheckAuth{User Authenticated?}
    
    CheckAuth -->|No| AuthPage[Auth Page]
    AuthPage --> SignUpOrIn{Sign Up or Sign In?}
    
    SignUpOrIn -->|Sign Up| EmailSignUp[Email/Password Signup]
    SignUpOrIn -->|Sign In| EmailSignIn[Email/Password Login]
    SignUpOrIn -->|Google| GoogleAuth[Google OAuth]
    
    EmailSignUp --> SendVerification[Send Email Verification]
    SendVerification --> VerifyEmail[Verify Email Page]
    
    EmailSignIn --> CheckVerified{Email Verified?}
    GoogleAuth --> CheckVerified
    
    CheckVerified -->|No| VerifyEmail
    CheckVerified -->|Yes| CheckInit{User Initialized?}
    
    VerifyEmail --> UserVerifies[User Verifies Email]
    UserVerifies --> CheckInit
    
    CheckInit -->|No| InitUser[Initialize User Data]
    InitUser --> CreateProfile[Create User Profile in Firestore]
    CreateProfile --> CreateDefaultAccounts[Create Default Accounts]
    CreateDefaultAccounts --> CreateDefaultCategories[Create Default Categories]
    CreateDefaultCategories --> SetInitFlag[Set isInitialized Flag]
    
    CheckInit -->|Yes| CheckAuth
    CheckAuth -->|Yes & Verified| Dashboard
    
    SetInitFlag --> Dashboard[Dashboard Page]
    
    Dashboard --> UserAction{User Action?}
    
    UserAction -->|View Dashboard| ViewStats[View Financial Stats]
    ViewStats --> UserAction
    
    UserAction -->|Manage Accounts| AccountsPage[Accounts Page]
    AccountsPage --> AccAction{Account Action?}
    AccAction -->|Create| CreateAccount[Add New Account]
    AccAction -->|Edit| EditAccount[Edit Account Details]
    AccAction -->|Delete| DeleteAccount[Delete Account]
    AccAction -->|View| ViewAccount[View Account Details]
    CreateAccount --> UpdateFirestore1[Update Firestore Accounts]
    EditAccount --> UpdateFirestore1
    DeleteAccount --> UpdateFirestore1
    UpdateFirestore1 --> AccountsPage
    
    UserAction -->|Manage Transactions| TransactionsPage[Transactions Page]
    TransactionsPage --> TransAction{Transaction Action?}
    TransAction -->|Add| AddTrans[Add Transaction Dialog]
    TransAction -->|Edit| EditTrans[Edit Transaction]
    TransAction -->|Delete| DeleteTrans[Delete Transaction]
    TransAction -->|Split| SplitTrans[Split Transaction]
    
    AddTrans --> TransType{Transaction Type?}
    TransType -->|Income| IncomeFlow[Select Income Category & Account]
    TransType -->|Expense| ExpenseFlow[Select Expense Category & Account]
    TransType -->|Transfer| TransferFlow[Select From & To Accounts]
    
    IncomeFlow --> SaveTrans[Save Transaction to Firestore]
    ExpenseFlow --> SaveTrans
    TransferFlow --> SaveTrans
    
    SaveTrans --> UpdateBalance[Update Account Balances]
    UpdateBalance --> TransactionsPage
    
    EditTrans --> SaveTrans
    DeleteTrans --> ReverseBalance[Reverse Balance Changes]
    ReverseBalance --> TransactionsPage
    
    SplitTrans --> CreateSplits[Create Split Entries]
    CreateSplits --> SaveTrans
    
    UserAction -->|View Reports| ReportsPage[Reports Page]
    ReportsPage --> RepAction{Report Action?}
    RepAction -->|Category Chart| ShowCategoryChart[Display Category Distribution]
    RepAction -->|Spending Trends| ShowSpendingChart[Display Spending Over Time]
    RepAction -->|Filter| FilterReports[Filter by Date/Category]
    ShowCategoryChart --> ReportsPage
    ShowSpendingChart --> ReportsPage
    FilterReports --> ReportsPage
    
    UserAction -->|Manage Profile| ProfilePage[Profile Page]
    ProfilePage --> ProfAction{Profile Action?}
    ProfAction -->|Update Photo| UploadPhoto[Upload Profile Photo to Storage]
    ProfAction -->|Update Name| UpdateName[Update Display Name]
    ProfAction -->|Change Password| ChangePassword[Change Password]
    
    UploadPhoto --> UpdateProfileDB[Update Profile in Firestore]
    UpdateName --> UpdateProfileDB
    UpdateProfileDB --> ProfilePage
    
    UserAction -->|Logout| LogoutUser[Sign Out]
    LogoutUser --> Start
    
    ViewAccount --> UserAction
    ProfilePage --> UserAction
    ReportsPage --> UserAction
    TransactionsPage --> UserAction
    AccountsPage --> UserAction
    ViewStats --> UserAction

    style Start fill:#4CAF50,stroke:#2E7D32,color:#fff
    style Dashboard fill:#2196F3,stroke:#1565C0,color:#fff
    style AuthPage fill:#FF9800,stroke:#E65100,color:#fff
    style InitUser fill:#9C27B0,stroke:#6A1B9A,color:#fff
    style SaveTrans fill:#00BCD4,stroke:#00838F,color:#fff
    style LogoutUser fill:#F44336,stroke:#C62828,color:#fff
        </div>
    </div>
    <script>
        mermaid.initialize({ 
            startOnLoad: true, 
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>
